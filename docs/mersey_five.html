<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Mersey V - Statistical analysis | Practical_1.knit</title>
  <meta name="description" content="<center>
Hydrological analysis in R
</center>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Mersey V - Statistical analysis | Practical_1.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Mersey V - Statistical analysis | Practical_1.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mersey_four.html"/>
<link rel="next" href="Assessment.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#practical-outline"><i class="fa fa-check"></i><b>1.1</b> Practical outline</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.2</b> Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.3</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Installation.html"><a href="Installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Installation.html"><a href="Installation.html#r"><i class="fa fa-check"></i><b>2.1</b> R</a></li>
<li class="chapter" data-level="2.2" data-path="Installation.html"><a href="Installation.html#r-studio"><i class="fa fa-check"></i><b>2.2</b> R Studio</a></li>
<li class="chapter" data-level="2.3" data-path="Installation.html"><a href="Installation.html#materials"><i class="fa fa-check"></i><b>2.3</b> Course materials</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Intro_to_R.html"><a href="Intro_to_R.html"><i class="fa fa-check"></i><b>3</b> A (brief) introduction to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#what-is-r"><i class="fa fa-check"></i><b>3.1.1</b> What is R?</a></li>
<li class="chapter" data-level="3.1.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#why_code"><i class="fa fa-check"></i><b>3.1.2</b> Why code?</a></li>
<li class="chapter" data-level="3.1.3" data-path="Intro_to_R.html"><a href="Intro_to_R.html#a-quick-note-on-the-practicals"><i class="fa fa-check"></i><b>3.1.3</b> A quick note on the practicals</a></li>
<li class="chapter" data-level="3.1.4" data-path="Intro_to_R.html"><a href="Intro_to_R.html#dealing-with-errors"><i class="fa fa-check"></i><b>3.1.4</b> Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#loading-r"><i class="fa fa-check"></i><b>3.2</b> Loading R</a></li>
<li class="chapter" data-level="3.3" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variables-looping"><i class="fa fa-check"></i><b>3.3</b> Variables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variable-names"><i class="fa fa-check"></i><b>3.3.1</b> Variable names</a></li>
<li class="chapter" data-level="3.3.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variables_types"><i class="fa fa-check"></i><b>3.3.2</b> Variable types</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data-structures"><i class="fa fa-check"></i><b>3.4</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#vectors"><i class="fa fa-check"></i><b>3.4.1</b> Vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_frames"><i class="fa fa-check"></i><b>3.4.2</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="Intro_to_R.html"><a href="Intro_to_R.html#scripts"><i class="fa fa-check"></i><b>3.5</b> Scripts</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#comments"><i class="fa fa-check"></i><b>3.5.1</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="Intro_to_R.html"><a href="Intro_to_R.html#packages"><i class="fa fa-check"></i><b>3.6</b> Loading packages</a></li>
<li class="chapter" data-level="3.7" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_loading"><i class="fa fa-check"></i><b>3.7</b> Loading data</a></li>
<li class="chapter" data-level="3.8" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_plotting"><i class="fa fa-check"></i><b>3.8</b> Plotting</a></li>
<li class="chapter" data-level="3.9" data-path="Intro_to_R.html"><a href="Intro_to_R.html#formative_task"><i class="fa fa-check"></i><b>3.9</b> Formative task</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#formative-solution"><i class="fa fa-check"></i><b>3.9.1</b> Formative solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="FirstPractical.html"><a href="FirstPractical.html"><i class="fa fa-check"></i><b>4</b> Eskdale I - Introduction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="FirstPractical.html"><a href="FirstPractical.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="FirstPractical.html"><a href="FirstPractical.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>4.1.1</b> Intended learning outcomes</a></li>
<li class="chapter" data-level="4.1.2" data-path="FirstPractical.html"><a href="FirstPractical.html#assessment"><i class="fa fa-check"></i><b>4.1.2</b> Assessment</a></li>
<li class="chapter" data-level="4.1.3" data-path="FirstPractical.html"><a href="FirstPractical.html#quiz"><i class="fa fa-check"></i><b>4.1.3</b> Quiz</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html"><i class="fa fa-check"></i><b>5</b> Eskdale II - Set-up</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#install-programs"><i class="fa fa-check"></i><b>5.1</b> Install programs</a></li>
<li class="chapter" data-level="5.2" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#download_data"><i class="fa fa-check"></i><b>5.2</b> Download data</a></li>
<li class="chapter" data-level="5.3" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#open-rstudio"><i class="fa fa-check"></i><b>5.3</b> Open RStudio</a></li>
<li class="chapter" data-level="5.4" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#R_Projects"><i class="fa fa-check"></i><b>5.4</b> Initialise an R project</a></li>
<li class="chapter" data-level="5.5" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#creating-an-r-script"><i class="fa fa-check"></i><b>5.5</b> Creating an R script</a></li>
<li class="chapter" data-level="5.6" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#install-whiteboxtools"><i class="fa fa-check"></i><b>5.6</b> Install WhiteboxTools</a></li>
<li class="chapter" data-level="5.7" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#loading-packages"><i class="fa fa-check"></i><b>5.7</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html"><i class="fa fa-check"></i><b>6</b> Eskdale III - Flow routing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#dem-pre-processing-flow-enforcement"><i class="fa fa-check"></i><b>6.1</b> DEM pre-processing: flow enforcement</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#data-description"><i class="fa fa-check"></i><b>6.1.1</b> Data description</a></li>
<li class="chapter" data-level="6.1.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#breaching-and-filling"><i class="fa fa-check"></i><b>6.1.2</b> Breaching and filling</a></li>
<li class="chapter" data-level="6.1.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#choosing-a-colour-ramp"><i class="fa fa-check"></i><b>6.1.3</b> Choosing a colour ramp</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#flow-parameters-pointers"><i class="fa fa-check"></i><b>6.2</b> Flow Parameters: Pointers</a></li>
<li class="chapter" data-level="6.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#flow-algorithms"><i class="fa fa-check"></i><b>6.3</b> Flow Algorithms</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#comparing-flow-algorithms"><i class="fa fa-check"></i><b>6.3.1</b> Comparing flow algorithms</a></li>
<li class="chapter" data-level="6.3.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#fd8-catchment-area"><i class="fa fa-check"></i><b>6.3.2</b> FD8 catchment area</a></li>
<li class="chapter" data-level="6.3.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#d-infinity-catchment-area"><i class="fa fa-check"></i><b>6.3.3</b> D-infinity catchment area</a></li>
<li class="chapter" data-level="6.3.4" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#comparing-the-outputs"><i class="fa fa-check"></i><b>6.3.4</b> Comparing the outputs</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#practical-solution"><i class="fa fa-check"></i><b>6.4</b> Practical solution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="SecondPractical.html"><a href="SecondPractical.html"><i class="fa fa-check"></i><b>7</b> Mersey I - Introduction</a>
<ul>
<li class="chapter" data-level="7.1" data-path="SecondPractical.html"><a href="SecondPractical.html#overview-2"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="SecondPractical.html"><a href="SecondPractical.html#topics-covered-in-this-practical"><i class="fa fa-check"></i><b>7.1.1</b> Topics covered in this practical</a></li>
<li class="chapter" data-level="7.1.2" data-path="SecondPractical.html"><a href="SecondPractical.html#intended-learning-outcomes-1"><i class="fa fa-check"></i><b>7.1.2</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="7.1.3" data-path="SecondPractical.html"><a href="SecondPractical.html#assessment-1"><i class="fa fa-check"></i><b>7.1.3</b> Assessment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html"><i class="fa fa-check"></i><b>8</b> Mersey II - Set-up</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#practical-overview"><i class="fa fa-check"></i><b>8.1</b> Practical overview</a></li>
<li class="chapter" data-level="8.2" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#install-programs-1"><i class="fa fa-check"></i><b>8.2</b> Install programs</a></li>
<li class="chapter" data-level="8.3" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#download_data_v2"><i class="fa fa-check"></i><b>8.3</b> Download data</a></li>
<li class="chapter" data-level="8.4" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#practical-2-data"><i class="fa fa-check"></i><b>8.4</b> Data description</a></li>
<li class="chapter" data-level="8.5" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#open-rstudio-1"><i class="fa fa-check"></i><b>8.5</b> Open RStudio</a></li>
<li class="chapter" data-level="8.6" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#projects-and-scripts"><i class="fa fa-check"></i><b>8.6</b> Projects and Scripts</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#Existing_R_Projects"><i class="fa fa-check"></i><b>8.6.1</b> Using an existing R project</a></li>
<li class="chapter" data-level="8.6.2" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#creating-an-r-script-1"><i class="fa fa-check"></i><b>8.6.2</b> Creating an R script</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#loading-packages-1"><i class="fa fa-check"></i><b>8.7</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mersey_three.html"><a href="mersey_three.html"><i class="fa fa-check"></i><b>9</b> Mersey III - Hydrology</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mersey_three.html"><a href="mersey_three.html#task-1-flow-routing"><i class="fa fa-check"></i><b>9.1</b> Task 1: Flow routing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mersey_three.html"><a href="mersey_three.html#creating-a-d8-pointer"><i class="fa fa-check"></i><b>9.1.1</b> Creating a D8 pointer</a></li>
<li class="chapter" data-level="9.1.2" data-path="mersey_three.html"><a href="mersey_three.html#catchment-area"><i class="fa fa-check"></i><b>9.1.2</b> Catchment area</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mersey_three.html"><a href="mersey_three.html#task-2-seed-points"><i class="fa fa-check"></i><b>9.2</b> Task 2: Seed points</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mersey_three.html"><a href="mersey_three.html#seed-repositioning"><i class="fa fa-check"></i><b>9.2.1</b> Seed repositioning</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mersey_three.html"><a href="mersey_three.html#task-3-watershed-creation"><i class="fa fa-check"></i><b>9.3</b> Task 3: Watershed creation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mersey_four.html"><a href="mersey_four.html"><i class="fa fa-check"></i><b>10</b> Mersey IV - Surface derivatives</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mersey_four.html"><a href="mersey_four.html#task-4-reclassification"><i class="fa fa-check"></i><b>10.1</b> Task 4: Reclassification</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="mersey_four.html"><a href="mersey_four.html#land-cover"><i class="fa fa-check"></i><b>10.1.1</b> Land cover</a></li>
<li class="chapter" data-level="10.1.2" data-path="mersey_four.html"><a href="mersey_four.html#hydrology-of-soil-types-host"><i class="fa fa-check"></i><b>10.1.2</b> Hydrology of Soil Types (HOST)</a></li>
<li class="chapter" data-level="10.1.3" data-path="mersey_four.html"><a href="mersey_four.html#bedrock-geology"><i class="fa fa-check"></i><b>10.1.3</b> Bedrock geology</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="mersey_four.html"><a href="mersey_four.html#task-5-calculating-surface-derivatives"><i class="fa fa-check"></i><b>10.2</b> Task 5: Calculating surface derivatives</a></li>
<li class="chapter" data-level="10.3" data-path="mersey_four.html"><a href="mersey_four.html#task-6-extracting-surface-derivatives"><i class="fa fa-check"></i><b>10.3</b> Task 6: Extracting surface derivatives</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="mersey_four.html"><a href="mersey_four.html#water-quality-measurements"><i class="fa fa-check"></i><b>10.3.1</b> Water quality measurements</a></li>
<li class="chapter" data-level="10.3.2" data-path="mersey_four.html"><a href="mersey_four.html#spatial-areas"><i class="fa fa-check"></i><b>10.3.2</b> Spatial areas</a></li>
<li class="chapter" data-level="10.3.3" data-path="mersey_four.html"><a href="mersey_four.html#continuous-derivatives"><i class="fa fa-check"></i><b>10.3.3</b> Continuous derivatives</a></li>
<li class="chapter" data-level="10.3.4" data-path="mersey_four.html"><a href="mersey_four.html#calculating-categorical-derivatives"><i class="fa fa-check"></i><b>10.3.4</b> Calculating categorical derivatives</a></li>
<li class="chapter" data-level="10.3.5" data-path="mersey_four.html"><a href="mersey_four.html#normalising-categorical-derivatives"><i class="fa fa-check"></i><b>10.3.5</b> Normalising categorical derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mersey_five.html"><a href="mersey_five.html"><i class="fa fa-check"></i><b>11</b> Mersey V - Statistical analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mersey_five.html"><a href="mersey_five.html#task-7-model-building"><i class="fa fa-check"></i><b>11.1</b> Task 7: Model building</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="mersey_five.html"><a href="mersey_five.html#an-introduction-to-linear-models-in-r"><i class="fa fa-check"></i><b>11.1.1</b> An introduction to linear models in R</a></li>
<li class="chapter" data-level="11.1.2" data-path="mersey_five.html"><a href="mersey_five.html#stepwise-regression"><i class="fa fa-check"></i><b>11.1.2</b> Stepwise regression</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="mersey_five.html"><a href="mersey_five.html#task-8-error-analysis"><i class="fa fa-check"></i><b>11.2</b> Task 8: Error analysis</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Assessment.html"><a href="Assessment.html"><i class="fa fa-check"></i><b>12</b> Assessment</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><center>
Hydrological analysis in R
</center></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mersey_five" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Mersey V - Statistical analysis</h1>
<p>In this final chapter, we will compare the information about catchment characteristics with the water quality data collected at each of the 70 monitoring stations. To begin, load the csv file created at the end of Task 6 (<code>mersey_watersheds_ea.csv</code>), saving to a new variable called <code>watersheds_df</code>:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="mersey_five.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reads completed file from csv</span></span>
<span id="cb131-2"><a href="mersey_five.html#cb131-2" aria-hidden="true" tabindex="-1"></a>watersheds_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_2&quot;</span>, <span class="st">&quot;mersey_watersheds_ea.csv&quot;</span>))</span></code></pre></div>
<p>If you have any other variables in your R environment, these can be removed using <code>rm()</code>.</p>
<div id="task-7-model-building" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Task 7: Model building</h2>
<p>This data frame should contain the following 10 water quality indicators for each watershed:</p>
<ul>
<li>pH: acidity/alkalinity;</li>
<li>SSC: suspended solids concentration;</li>
<li>Ca: calcium;</li>
<li>Mg: magnesium;</li>
<li>NH<sub>4</sub>: ammonium;</li>
<li>NO<sub>3</sub>: nitrate;</li>
<li>NO<sub>2</sub>: nitrite;</li>
<li>TON: total oxidised nitrogen;</li>
<li>PO<sub>4</sub>: phosphate;</li>
<li>Zn: zinc.</li>
</ul>
<p>It should also contain the continuous derivatives (e.g. average elevation) and categorical derivatives (e.g. land cover percentage) for each watershed.</p>
<p><strong>Note</strong>: some of your calculated percentages may not add up to 100%. In Task 4, we reclassified only the most important categorical variables. These are known to have the greatest impact of river hydrochemistry (e.g. urban areas, farmland). While other land cover categories are found within each watershed, these typically account for only a small percentage of the total area and have a limited effect on the river environment. These categories have been excluded to simplify the analysis.</p>
<div id="an-introduction-to-linear-models-in-r" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> An introduction to linear models in R</h3>
<p>It is now time to examine the relationships between river water quality and catchment metrics. The key model outputs that are ultimately required for the assessment are:</p>
<ol style="list-style-type: decimal">
<li><p>Regression equations for each water quality variable (dependent variable; n = 10) and the key explanatory catchment characteristics (independent variables; n = 16).</p></li>
<li><p>Associated model values (R<sup>2</sup>, <em>p</em> value).</p></li>
</ol>
<blockquote>
<p>Remember, you don’t have to run every code block shown below, but you can do so if it would help your understanding.</p>
</blockquote>
<p>The simplest way to run a linear regression in R is to use the <code>lm()</code> function, an example of which is shown below, storing the output in <code>model</code> (you can change this name to reflect the input variables):</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="mersey_five.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fits a linear model</span></span>
<span id="cb132-2"><a href="mersey_five.html#cb132-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> NO2 <span class="sc">~</span> average_elevation, <span class="at">data =</span> watersheds_df)</span></code></pre></div>
<p>We have defined the data frame being used (<code>data = watersheds_df</code>) and the input variables from that data frame. This is achieved by including their column names, shown here:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="mersey_five.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(watersheds_df)</span></code></pre></div>
<pre><code>##  [1] &quot;Seed_Point_ID&quot;          &quot;FID&quot;                    &quot;EA_ID&quot;                 
##  [4] &quot;Ph&quot;                     &quot;SSC&quot;                    &quot;Ca&quot;                    
##  [7] &quot;Mg&quot;                     &quot;NH4&quot;                    &quot;NO3&quot;                   
## [10] &quot;NO2&quot;                    &quot;TON&quot;                    &quot;PO4&quot;                   
## [13] &quot;Zn&quot;                     &quot;area&quot;                   &quot;count&quot;                 
## [16] &quot;average_elevation&quot;      &quot;average_rainfall&quot;       &quot;average_slope&quot;         
## [19] &quot;average_aspect&quot;         &quot;Arable&quot;                 &quot;Heath&quot;                 
## [22] &quot;Grassland&quot;              &quot;Urban&quot;                  &quot;Wetland&quot;               
## [25] &quot;Permeable&quot;              &quot;Impermeable&quot;            &quot;Gleyed&quot;                
## [28] &quot;Peats&quot;                  &quot;Sands_and_Muds&quot;         &quot;Limestone&quot;             
## [31] &quot;Coal&quot;                   &quot;Arable_percent&quot;         &quot;Heath_percent&quot;         
## [34] &quot;Grassland_percent&quot;      &quot;Urban_percent&quot;          &quot;Wetland_percent&quot;       
## [37] &quot;Permeable_percent&quot;      &quot;Impermeable_percent&quot;    &quot;Gleyed_percent&quot;        
## [40] &quot;Peats_percent&quot;          &quot;Sands_and_Muds_percent&quot; &quot;Limestone_percent&quot;     
## [43] &quot;Coal_percent&quot;</code></pre>
<p>Input variables in the <strong>formula</strong> are separated by <code>~</code>, where the variable to the left is the dependent variable (<code>NO2</code>) and the variable to the right is an independent variable (<code>average_elevation</code>). We can, however, include <strong>multiple</strong> independent variables to perform multiple linear regression. This is achieved as follows, where additional independent variables are separated by <code>+</code>:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="mersey_five.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fits a linear model</span></span>
<span id="cb135-2"><a href="mersey_five.html#cb135-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> NO2 <span class="sc">~</span> average_elevation <span class="sc">+</span> average_rainfall, <span class="at">data =</span> watersheds_df)</span></code></pre></div>
<p>We can then assess the model output using the <code>summary</code> function:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="mersey_five.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = NO2 ~ average_elevation + average_rainfall, data = watersheds_df)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.059950 -0.015188 -0.010499  0.002269  0.226625 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)        9.525e-02  3.198e-02   2.978  0.00403 **
## average_elevation -2.096e-04  8.951e-05  -2.341  0.02220 * 
## average_rainfall  -8.358e-06  5.450e-05  -0.153  0.87857   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04402 on 67 degrees of freedom
## Multiple R-squared:  0.3109, Adjusted R-squared:  0.2903 
## F-statistic: 15.11 on 2 and 67 DF,  p-value: 3.828e-06</code></pre>
<p>For this set of independent variables, we have an R<sup>2</sup> of 0.32 (<code>Multiple R-squared: 0.3109</code>) and a model <em>p</em> value of &lt; 0.01 (<code>p-value: 3.828e-06</code>).</p>
<p>The model coefficients for the independent variables are described above, where <code>*</code> denotes <em>p</em> values &lt; 0.05 (95% probability) and <code>**</code> denotes <em>p</em> values &lt; 0.01 (99% probability). As the coefficients are very small, they are presented in scientific notation. These can be converted to numeric (non-scientific) format using the following code:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="mersey_five.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="sc">-</span><span class="fl">2.096e-04</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;-0.0002096&quot;</code></pre>
<p>We can supply multiple values to the <code>format</code> function by creating a vector:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="mersey_five.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.096e-04</span>, <span class="sc">-</span><span class="fl">8.358e-06</span>, ...) , <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<blockquote>
<p>When you’re happy you understanding the formatting of the <code>lm</code> function, move on to the next section.</p>
</blockquote>
</div>
<div id="stepwise-regression" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Stepwise regression</h3>
<p>However, one of the weaknesses of the above approach is that we have manually defined the independent variables of interest (<code>average_elevation + average_rainfall</code>). For exploratory analysis, however, we may not know which are the most important variables. Perhaps there is a combination of independent variables which produces a better model fit (e.g. R<sup>2</sup> &gt; 0.32)?</p>
<p>To test this, we’re going to include <strong>all</strong> the relevant independent variables in the analysis and then select those with the greatest explanatory power using <strong>Stepwise Regression</strong> (from the <code>MASS</code> package).</p>
<p>We don’t necessarily want to test all model variables, however. We would probably want to exclude the categorical counts (e.g. Arable, Heath, …) as these factors are already represented by the normalised variables (e.g. Arable_percent, Heath_percent, …), as well as any IDs or geometry variables (area). In general, we are only interested in testing the continuous derivatives (column names starting with <code>average_</code>) and the normalised categorical derivatives (column names ending in ’_percent’).</p>
<p>Rather than typing out the columns of interest manually, we are going to use the <code>select</code> function from the <code>dplyr</code> package to do so:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="mersey_five.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a vector of column names, including only those which contain &quot;average&quot; or &quot;percent&quot;</span></span>
<span id="cb141-2"><a href="mersey_five.html#cb141-2" aria-hidden="true" tabindex="-1"></a>factors <span class="ot">&lt;-</span> <span class="fu">colnames</span>(watersheds_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">&quot;average&quot;</span>, <span class="st">&quot;percent&quot;</span>))))</span>
<span id="cb141-3"><a href="mersey_five.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="mersey_five.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints to console</span></span>
<span id="cb141-5"><a href="mersey_five.html#cb141-5" aria-hidden="true" tabindex="-1"></a>factors</span></code></pre></div>
<pre><code>##  [1] &quot;average_elevation&quot;      &quot;average_rainfall&quot;       &quot;average_slope&quot;         
##  [4] &quot;average_aspect&quot;         &quot;Arable_percent&quot;         &quot;Heath_percent&quot;         
##  [7] &quot;Grassland_percent&quot;      &quot;Urban_percent&quot;          &quot;Wetland_percent&quot;       
## [10] &quot;Permeable_percent&quot;      &quot;Impermeable_percent&quot;    &quot;Gleyed_percent&quot;        
## [13] &quot;Peats_percent&quot;          &quot;Sands_and_Muds_percent&quot; &quot;Limestone_percent&quot;     
## [16] &quot;Coal_percent&quot;</code></pre>
<blockquote>
<p>Run the above code. <strong>Note</strong>, the formatting of <code>dplyr::select</code> may be slightly confusing but it is necessary because there is also a <code>select</code> function in the <code>MASS</code> package. Here, we are telling R to use <code>select</code> from <code>dplyr</code>.</p>
</blockquote>
<p>Using the vector of column names, we are going to create a new data frame (called <code>variables</code>) containing only the independent variables of interest:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="mersey_five.html#cb143-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> watersheds_df[factors]</span></code></pre></div>
<blockquote>
<p>Run the above code and use <code>head()</code> to inspect the results.</p>
</blockquote>
<p>Next, we are going to combine this data frame (<code>cbind</code>) with the dependent variable of interest (NO<sub>2</sub>). We’ll call this <code>model_df</code> as it contains all the variables (dependent + independent) required for multiple linear regression. <strong>Note</strong>: by default, <code>cbind</code> will (somewhat unhelpfully) rename input column names e.g. <code>NO2</code> will become <code>watersheds_df$NO2</code>. The code below specifies the new column name as NO2 (<code>NO2 =</code>) for readability:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="mersey_five.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column bind the NO2 column from watersheds_df with the data frame containing all the independent variables </span></span>
<span id="cb144-2"><a href="mersey_five.html#cb144-2" aria-hidden="true" tabindex="-1"></a>model_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">NO2 =</span> watersheds_df<span class="sc">$</span>NO2, variables)</span></code></pre></div>
<p>When complete, we can then run a new model, making sure to update the data frame used (<code>data = model_df</code>) and updating the formula to <code>NO2 ~ .</code>. This denotes that <em>all</em> other data frame columns will be included as independent variables (a useful time saver!):</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="mersey_five.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fits a linear model</span></span>
<span id="cb145-2"><a href="mersey_five.html#cb145-2" aria-hidden="true" tabindex="-1"></a>no2_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> NO2 <span class="sc">~</span> ., <span class="at">data =</span> model_df)</span></code></pre></div>
<blockquote>
<p>When you’re happy you understand the <code>lm</code> syntax, combine the two dataframes, run the linear model and inspect the output using <code>summary()</code>. This should resemble the following:</p>
</blockquote>
<pre><code>## 
## Call:
## lm(formula = NO2 ~ ., data = model_df)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.079376 -0.020381  0.000134  0.012654  0.174510 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)            -2.862e-01  1.780e+00  -0.161   0.8729  
## average_elevation       2.658e-04  2.222e-04   1.196   0.2369  
## average_rainfall       -8.230e-06  7.071e-05  -0.116   0.9078  
## average_slope          -1.188e-02  8.469e-03  -1.403   0.1664  
## average_aspect         -5.281e-05  1.614e-04  -0.327   0.7448  
## Arable_percent         -9.127e-04  9.229e-04  -0.989   0.3272  
## Heath_percent          -1.526e-03  1.273e-03  -1.199   0.2358  
## Grassland_percent      -1.653e-03  9.247e-04  -1.787   0.0796 .
## Urban_percent          -2.907e-04  9.812e-04  -0.296   0.7682  
## Wetland_percent        -1.362e-03  1.096e-03  -1.243   0.2194  
## Permeable_percent       3.946e-03  1.734e-02   0.228   0.8209  
## Impermeable_percent     2.880e-03  1.729e-02   0.167   0.8684  
## Gleyed_percent          3.649e-03  1.734e-02   0.210   0.8341  
## Peats_percent           3.289e-03  1.740e-02   0.189   0.8508  
## Sands_and_Muds_percent  1.035e-03  3.016e-03   0.343   0.7329  
## Limestone_percent       1.473e-03  3.528e-03   0.417   0.6780  
## Coal_percent            1.008e-03  2.999e-03   0.336   0.7382  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04256 on 53 degrees of freedom
## Multiple R-squared:  0.4905, Adjusted R-squared:  0.3367 
## F-statistic: 3.189 on 16 and 53 DF,  p-value: 0.0007589</code></pre>
<p>Our overall model fit (R<sup>2</sup>) is 0.49 which indicates that the independent variables explain ~49% of variability in the dependent variable. However, the model contains many independent variables which are not statistically significant, here defined as having a <em>p</em> value &gt; 0.05.</p>
<p>This number represents the probability that the result has occurred by chance. When values are very small (e.g. <em>p</em> &lt; 0.0005), we would typically present these as a discrete value e.g. <em>p</em> &lt; 0.05, &lt; 0.01, &lt; 0.001. Generally, we only use models in which we can be 95% confident or higher (i.e. significance level of 0.05 or less).</p>
<p>However, it is important to note that <em>p</em> values should be not be considered in isolation and need to be interpreted carefully. For statistical reviews of using and interpreting <em>p</em> values, see <span class="citation"><a href="#ref-goodman_dirty_2008" role="doc-biblioref">Goodman</a> (<a href="#ref-goodman_dirty_2008" role="doc-biblioref">2008</a>)</span> and <span class="citation"><a href="#ref-andrade_p_2019" role="doc-biblioref">Andrade</a> (<a href="#ref-andrade_p_2019" role="doc-biblioref">2019</a>)</span>. For a broader overview, see the <em>Nature</em> commentary by <span class="citation"><a href="#ref-amrhein_scientists_2019" role="doc-biblioref">Amrhein <em>et al.</em></a> (<a href="#ref-amrhein_scientists_2019" role="doc-biblioref">2019</a>)</span>, as well as a summary article by <a href="https://www.vox.com/latest-news/2019/3/22/18275913/statistical-significance-p-values-explained">Vox</a>.</p>
<p>To filter our independent variables to include only the most important, we can use the <code>step.AIC</code> function from the <code>MASS</code> library as follows:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="mersey_five.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise regression model</span></span>
<span id="cb147-2"><a href="mersey_five.html#cb147-2" aria-hidden="true" tabindex="-1"></a>step.model <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(no2_model, <span class="co"># Input linear model</span></span>
<span id="cb147-3"><a href="mersey_five.html#cb147-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb147-4"><a href="mersey_five.html#cb147-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># Print out intermediate results? </span></span>
<span id="cb147-5"><a href="mersey_five.html#cb147-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">k =</span> <span class="dv">1</span>) </span></code></pre></div>
<p>Helpfully, this takes the output of the <code>lm</code> model (<code>no2_model</code>) with no need for any additional data wrangling. The following are important parameters:</p>
<ul>
<li><code>direction = "both"</code>:
<ul>
<li>Determines the method used, either <strong>forward</strong> or <strong>backward</strong> stepwise regression, or a mixture of <strong>both</strong>.</li>
<li>“Forward” begins with a model with <strong>no</strong> variables and then starts adding the most significant variables, stopping when there are no more significant variables.</li>
<li>“Backward” begins with a model with <strong>all</strong> variables and then starts removing the least significant variables, stopping when only significant variables are remaining.</li>
<li>“Both” includes both of the above.</li>
</ul></li>
<li><code>k = 1</code>:
<ul>
<li>The number of degrees of freedom used for the penalty i.e. for determining whether variables are significant or not.</li>
</ul></li>
</ul>
<blockquote>
<p>Run the above model (<code>direction = "both"</code> and <code>k = 1</code>) and print the output using <code>summary()</code>:</p>
</blockquote>
<pre><code>## 
## Call:
## lm(formula = NO2 ~ average_elevation + average_slope + Arable_percent + 
##     Heath_percent + Grassland_percent + Wetland_percent + Permeable_percent + 
##     Gleyed_percent, data = model_df)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.073206 -0.024423 -0.001572  0.011732  0.173498 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        0.1022932  0.0318332   3.213 0.002097 ** 
## average_elevation  0.0002730  0.0001814   1.505 0.137485    
## average_slope     -0.0122713  0.0070213  -1.748 0.085546 .  
## Arable_percent    -0.0005464  0.0004921  -1.110 0.271209    
## Heath_percent     -0.0012936  0.0008355  -1.548 0.126706    
## Grassland_percent -0.0014058  0.0004046  -3.474 0.000948 ***
## Wetland_percent   -0.0010922  0.0006835  -1.598 0.115189    
## Permeable_percent  0.0007075  0.0003031   2.334 0.022908 *  
## Gleyed_percent     0.0003857  0.0002536   1.521 0.133507    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03989 on 61 degrees of freedom
## Multiple R-squared:  0.4847, Adjusted R-squared:  0.4171 
## F-statistic: 7.173 on 8 and 61 DF,  p-value: 1.19e-06</code></pre>
<p>As you can see above, using a low threshold for the degrees of freedom (<code>k = 1</code>) means we still have many “non-significant” variables remaining (<em>p</em> &gt; 0.05)</p>
<blockquote>
<p>Re-run the above model, but increasing the value of <code>k</code> in intervals of 1 until all the independent variables are significant at <em>p</em> = 0.05 (denoted by <code>*</code>):</p>
</blockquote>
<pre><code>## 
## Call:
## lm(formula = NO2 ~ average_slope + Urban_percent, data = model_df)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.064188 -0.020809 -0.004947  0.011032  0.192829 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    0.0491099  0.0144297   3.403  0.00113 **
## average_slope -0.0047714  0.0018903  -2.524  0.01397 * 
## Urban_percent  0.0011327  0.0003502   3.234  0.00190 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04078 on 67 degrees of freedom
## Multiple R-squared:  0.4086, Adjusted R-squared:  0.391 
## F-statistic: 23.15 on 2 and 67 DF,  p-value: 2.274e-08</code></pre>
<p>In general, we prefer models with the minimum number of parameters (independent variables). They require fewer assumptions, less intensive data collection and can be applied more confidently to new data sets/locations. This approach is based upon <strong>Occam’s Razor</strong>: <em>other things being equal, simpler explanations are generally better than more complex ones</em>.</p>
<p>Our original model, based upon 16 independent variables had an R<sup>2</sup> of 0.49. This new model, based upon just 2 independent variables (<code>average_slope + Urban_percent</code>) has an R<sup>2</sup> of 0.41; a minor reduction in explanatory power given the removal of 14 (arguably unimportant) additional variables.</p>
<p>Our model coefficients are now as follows:</p>
<ul>
<li><code>intercept</code> = 0.0491099, <em>p</em> = 0.00113 (<em>p</em> &lt; 0.01)</li>
<li><code>average_slope</code> = -0.0047714, <em>p</em> = 0.01397 (<em>p</em> &lt; 0.05)</li>
<li><code>Urban_percent</code> = 0.0011327, <em>p</em> = 0.00190 (<em>p</em> &lt; 0.01)</li>
</ul>
<p>Coefficients are important because they are used in <strong>regression equations</strong>, which can then be used to predict values.</p>
<p>The general format for a regression equation is as follows:</p>
<p><span class="math display">\[
y = a + (b_1 \cdot x_1) + (b_2 \cdot x_2) + (b_n \cdot x_n)
\]</span>
where <code>a</code> is the constant (intercept) value, and <code>b</code> is the coefficient of x.</p>
<p>For our NO<sub>2</sub> model above, we can define our regression equation (presented using sensible data precision) as:</p>
<p><span class="math display">\[
NO_2 = 0.049 + (0.001 \cdot Urban \: percent) + (-0.005 \cdot Average \: slope)
\]</span>
<strong>Well done!</strong> You have now calculated a regression which links the dependent variable (NO<sub>2</sub>) to a set of independent variables, in the case the average elevation of the watershed and the percentage urban land cover.</p>
</div>
</div>
<div id="task-8-error-analysis" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Task 8: Error analysis</h2>
<p>Using this regression equation, we could predict NO<sub>2</sub> values for the sampled watersheds to assess how well it reproduces the actual measured values. Comparison plots of <strong>measured vs. modelled (or predicted) values</strong> are just one way to assess model quality, alongside other metrics such as root-mean-square error (RMSE), normalised root-mean-square-error (nRMSE), Q-Q plots, or histograms of model residuals. You may want to explore some of these for the assessment.</p>
<p>To calculate modelled values, we can use the <code>predict()</code> function, taking the model variable (<code>step.model</code>) as the input, rather than re-creating the above equation manually in code:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="mersey_five.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicts based on upon stepwise model, saving to watersheds dataframe</span></span>
<span id="cb150-2"><a href="mersey_five.html#cb150-2" aria-hidden="true" tabindex="-1"></a>watersheds_df<span class="sc">$</span>predicted_no2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(step.model)</span></code></pre></div>
<p>As we haven’t specified any <code>new_data</code> (a <code>predict</code> parameter; see <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/predict.lm">here</a>), this uses the fitted values for prediction.</p>
<blockquote>
<p>Run the above code block to predict the NO<sub>2</sub> based on the regression equation.</p>
</blockquote>
<p>These values could be used to calculate RMSE or other metrics (nRMSE) using your own code or additional packages (e.g. <code>Metrics</code>);</p>
<p><span class="math display">\[
 RMSE = \sqrt{mean(measured\:values - modelled\:values)^2}
\]</span></p>
<p>Plots of measured vs. modelled values (as well as Q-Q plots and histograms) can be created in ggplot2. Here is an example:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="mersey_five.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot of measured vs. modelled (predicted) NO2 values</span></span>
<span id="cb151-2"><a href="mersey_five.html#cb151-2" aria-hidden="true" tabindex="-1"></a>no2_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> watersheds_df, <span class="fu">aes</span>(<span class="at">x =</span> predicted_no2, <span class="at">y =</span> NO2)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="mersey_five.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adds the point data, modifying the shape, size, colour and fill</span></span>
<span id="cb151-4"><a href="mersey_five.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#5695FF&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb151-5"><a href="mersey_five.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a linear regression (&quot;lm&quot;), removing standard error bars (se = FALSE)</span></span>
<span id="cb151-6"><a href="mersey_five.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&quot;#FF7A71&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-7"><a href="mersey_five.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a 1:1 line for comparison</span></span>
<span id="cb151-8"><a href="mersey_five.html#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-9"><a href="mersey_five.html#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Setting the theme and aspect ratio</span></span>
<span id="cb151-10"><a href="mersey_five.html#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb151-11"><a href="mersey_five.html#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb151-12"><a href="mersey_five.html#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add axis labels and a title</span></span>
<span id="cb151-13"><a href="mersey_five.html#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Modelled NO2&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Measured NO2&quot;</span>, </span>
<span id="cb151-14"><a href="mersey_five.html#cb151-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">bquote</span>(<span class="st">&#39;Plot of measured vs. modelled&#39;</span><span class="sc">~</span>NO[<span class="dv">2</span>]<span class="sc">~</span><span class="st">&#39;values&#39;</span>))</span>
<span id="cb151-15"><a href="mersey_five.html#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="mersey_five.html#cb151-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-17"><a href="mersey_five.html#cb151-17" aria-hidden="true" tabindex="-1"></a>no2_plot</span></code></pre></div>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-155-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br/></p>
<p><strong>To finish the practical</strong> and to prepare for the assessment:</p>
<blockquote>
<p>Replicating the above approaches (Task 7), calculate regression equations based on stepwise linear regression for all 10 water quality indicators (NO<sub>2</sub>, pH, SSC, Ca, Mg, NH<sub>4</sub>, NO<sub>3</sub>, TON, PO<sub>4</sub>, Zn).</p>
</blockquote>
<blockquote>
<p>Use the same approach to create new data frames for each indicator, remembering to update the <code>k</code> parameter in the <code>step.AIC</code> function (beginnin at <code>k = 1</code>) to determine the statistically significant variables.</p>
</blockquote>
<blockquote>
<p>Save the relevant model coefficients and the R<sup>2</sup> and <em>p</em> values for each equation. These should be stored in a single table for the assessment.</p>
</blockquote>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-amrhein_scientists_2019" class="csl-entry">
Amrhein, V. <em>et al.</em> (2019) <span>‘Scientists rise up against statistical significance’</span>, <em>Nature</em>, 567(7748), pp. 305–307. doi:<a href="https://doi.org/10.1038/d41586-019-00857-9">10.1038/d41586-019-00857-9</a>.
</div>
<div id="ref-andrade_p_2019" class="csl-entry">
Andrade, C. (2019) <span>‘The <span>P</span> <span>Value</span> and <span>Statistical</span> <span>Significance</span>: <span>Misunderstandings</span>, <span>Explanations</span>, <span>Challenges</span>, and <span>Alternatives</span>’</span>, <em>Indian Journal of Psychological Medicine</em>, 41(3), pp. 210–215. doi:<a href="https://doi.org/10.4103/IJPSYM.IJPSYM_193_19">10.4103/IJPSYM.IJPSYM_193_19</a>.
</div>
<div id="ref-goodman_dirty_2008" class="csl-entry">
Goodman, S. (2008) <span>‘A <span>Dirty</span> <span>Dozen</span>: <span>Twelve</span> <span>P</span>-<span>Value</span> <span>Misconceptions</span>’</span>, <em>Seminars in Hematology</em>, 45(3), pp. 135–140. doi:<a href="https://doi.org/10.1053/j.seminhematol.2008.04.003">10.1053/j.seminhematol.2008.04.003</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mersey_four.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Assessment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
