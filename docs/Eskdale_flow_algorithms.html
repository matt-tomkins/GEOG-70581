<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Eskdale III - Flow routing | Practical_1.knit</title>
  <meta name="description" content="<center>
Hydrological analysis in R
</center>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Eskdale III - Flow routing | Practical_1.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Eskdale III - Flow routing | Practical_1.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Eskdale_set_up.html"/>
<link rel="next" href="SecondPractical.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#practical-outline"><i class="fa fa-check"></i><b>1.1</b> Practical outline</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.2</b> Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.3</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Installation.html"><a href="Installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Installation.html"><a href="Installation.html#r"><i class="fa fa-check"></i><b>2.1</b> R</a></li>
<li class="chapter" data-level="2.2" data-path="Installation.html"><a href="Installation.html#r-studio"><i class="fa fa-check"></i><b>2.2</b> R Studio</a></li>
<li class="chapter" data-level="2.3" data-path="Installation.html"><a href="Installation.html#materials"><i class="fa fa-check"></i><b>2.3</b> Course materials</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Intro_to_R.html"><a href="Intro_to_R.html"><i class="fa fa-check"></i><b>3</b> A (brief) introduction to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#what-is-r"><i class="fa fa-check"></i><b>3.1.1</b> What is R?</a></li>
<li class="chapter" data-level="3.1.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#why_code"><i class="fa fa-check"></i><b>3.1.2</b> Why code?</a></li>
<li class="chapter" data-level="3.1.3" data-path="Intro_to_R.html"><a href="Intro_to_R.html#a-quick-note-on-the-practicals"><i class="fa fa-check"></i><b>3.1.3</b> A quick note on the practicals</a></li>
<li class="chapter" data-level="3.1.4" data-path="Intro_to_R.html"><a href="Intro_to_R.html#dealing-with-errors"><i class="fa fa-check"></i><b>3.1.4</b> Dealing with errors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#loading-r"><i class="fa fa-check"></i><b>3.2</b> Loading R</a></li>
<li class="chapter" data-level="3.3" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variable-names"><i class="fa fa-check"></i><b>3.3.1</b> Variable names</a></li>
<li class="chapter" data-level="3.3.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#variables_types"><i class="fa fa-check"></i><b>3.3.2</b> Variable types</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data-structures"><i class="fa fa-check"></i><b>3.4</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#vectors"><i class="fa fa-check"></i><b>3.4.1</b> Vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_frames"><i class="fa fa-check"></i><b>3.4.2</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="Intro_to_R.html"><a href="Intro_to_R.html#scripts"><i class="fa fa-check"></i><b>3.5</b> Scripts</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#comments"><i class="fa fa-check"></i><b>3.5.1</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="Intro_to_R.html"><a href="Intro_to_R.html#packages"><i class="fa fa-check"></i><b>3.6</b> Loading packages</a></li>
<li class="chapter" data-level="3.7" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_loading"><i class="fa fa-check"></i><b>3.7</b> Loading data</a></li>
<li class="chapter" data-level="3.8" data-path="Intro_to_R.html"><a href="Intro_to_R.html#data_plotting"><i class="fa fa-check"></i><b>3.8</b> Plotting</a></li>
<li class="chapter" data-level="3.9" data-path="Intro_to_R.html"><a href="Intro_to_R.html#formative_task"><i class="fa fa-check"></i><b>3.9</b> Formative task</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="Intro_to_R.html"><a href="Intro_to_R.html#formative-solution"><i class="fa fa-check"></i><b>3.9.1</b> Formative solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="FirstPractical.html"><a href="FirstPractical.html"><i class="fa fa-check"></i><b>4</b> Eskdale I - Introduction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="FirstPractical.html"><a href="FirstPractical.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="FirstPractical.html"><a href="FirstPractical.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>4.1.1</b> Intended learning outcomes</a></li>
<li class="chapter" data-level="4.1.2" data-path="FirstPractical.html"><a href="FirstPractical.html#assessment"><i class="fa fa-check"></i><b>4.1.2</b> Assessment</a></li>
<li class="chapter" data-level="4.1.3" data-path="FirstPractical.html"><a href="FirstPractical.html#quiz"><i class="fa fa-check"></i><b>4.1.3</b> Quiz</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html"><i class="fa fa-check"></i><b>5</b> Eskdale II - Set-up</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#install-programs"><i class="fa fa-check"></i><b>5.1</b> Install programs</a></li>
<li class="chapter" data-level="5.2" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#download_data"><i class="fa fa-check"></i><b>5.2</b> Download data</a></li>
<li class="chapter" data-level="5.3" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#open-rstudio"><i class="fa fa-check"></i><b>5.3</b> Open RStudio</a></li>
<li class="chapter" data-level="5.4" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#R_Projects"><i class="fa fa-check"></i><b>5.4</b> Initialise an R project</a></li>
<li class="chapter" data-level="5.5" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#creating-an-r-script"><i class="fa fa-check"></i><b>5.5</b> Creating an R script</a></li>
<li class="chapter" data-level="5.6" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#install-whiteboxtools"><i class="fa fa-check"></i><b>5.6</b> Install WhiteboxTools</a></li>
<li class="chapter" data-level="5.7" data-path="Eskdale_set_up.html"><a href="Eskdale_set_up.html#loading-packages"><i class="fa fa-check"></i><b>5.7</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html"><i class="fa fa-check"></i><b>6</b> Eskdale III - Flow routing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#dem-pre-processing-flow-enforcement"><i class="fa fa-check"></i><b>6.1</b> DEM pre-processing: flow enforcement</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#data-description"><i class="fa fa-check"></i><b>6.1.1</b> Data description</a></li>
<li class="chapter" data-level="6.1.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#breaching-and-filling"><i class="fa fa-check"></i><b>6.1.2</b> Breaching and filling</a></li>
<li class="chapter" data-level="6.1.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#choosing-a-colour-ramp"><i class="fa fa-check"></i><b>6.1.3</b> Choosing a colour ramp</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#flow-parameters-pointers"><i class="fa fa-check"></i><b>6.2</b> Flow Parameters: Pointers</a></li>
<li class="chapter" data-level="6.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#flow-algorithms"><i class="fa fa-check"></i><b>6.3</b> Flow Algorithms</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#comparing-flow-algorithms"><i class="fa fa-check"></i><b>6.3.1</b> Comparing flow algorithms</a></li>
<li class="chapter" data-level="6.3.2" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#fd8-catchment-area"><i class="fa fa-check"></i><b>6.3.2</b> FD8 catchment area</a></li>
<li class="chapter" data-level="6.3.3" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#d-infinity-catchment-area"><i class="fa fa-check"></i><b>6.3.3</b> D-infinity catchment area</a></li>
<li class="chapter" data-level="6.3.4" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#comparing-the-outputs"><i class="fa fa-check"></i><b>6.3.4</b> Comparing the outputs</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Eskdale_flow_algorithms.html"><a href="Eskdale_flow_algorithms.html#practical-solution"><i class="fa fa-check"></i><b>6.4</b> Practical solution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="SecondPractical.html"><a href="SecondPractical.html"><i class="fa fa-check"></i><b>7</b> Mersey I - Introduction</a>
<ul>
<li class="chapter" data-level="7.1" data-path="SecondPractical.html"><a href="SecondPractical.html#overview-2"><i class="fa fa-check"></i><b>7.1</b> Overview</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="SecondPractical.html"><a href="SecondPractical.html#topics-covered-in-this-practical"><i class="fa fa-check"></i><b>7.1.1</b> Topics covered in this practical</a></li>
<li class="chapter" data-level="7.1.2" data-path="SecondPractical.html"><a href="SecondPractical.html#intended-learning-outcomes-1"><i class="fa fa-check"></i><b>7.1.2</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="7.1.3" data-path="SecondPractical.html"><a href="SecondPractical.html#assessment-1"><i class="fa fa-check"></i><b>7.1.3</b> Assessment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html"><i class="fa fa-check"></i><b>8</b> Mersey II - Set-up</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#practical-overview"><i class="fa fa-check"></i><b>8.1</b> Practical overview</a></li>
<li class="chapter" data-level="8.2" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#install-programs-1"><i class="fa fa-check"></i><b>8.2</b> Install programs</a></li>
<li class="chapter" data-level="8.3" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#download_data_v2"><i class="fa fa-check"></i><b>8.3</b> Download data</a></li>
<li class="chapter" data-level="8.4" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#practical-2-data"><i class="fa fa-check"></i><b>8.4</b> Data description</a></li>
<li class="chapter" data-level="8.5" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#open-rstudio-1"><i class="fa fa-check"></i><b>8.5</b> Open RStudio</a></li>
<li class="chapter" data-level="8.6" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#projects-and-scripts"><i class="fa fa-check"></i><b>8.6</b> Projects and Scripts</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#Existing_R_Projects"><i class="fa fa-check"></i><b>8.6.1</b> Using an existing R project</a></li>
<li class="chapter" data-level="8.6.2" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#creating-an-r-script-1"><i class="fa fa-check"></i><b>8.6.2</b> Creating an R script</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="Mersy_set_up.html"><a href="Mersy_set_up.html#loading-packages-1"><i class="fa fa-check"></i><b>8.7</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mersey_three.html"><a href="mersey_three.html"><i class="fa fa-check"></i><b>9</b> Mersey III - Hydrology</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mersey_three.html"><a href="mersey_three.html#task-1-flow-routing"><i class="fa fa-check"></i><b>9.1</b> Task 1: Flow routing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mersey_three.html"><a href="mersey_three.html#creating-a-d8-pointer"><i class="fa fa-check"></i><b>9.1.1</b> Creating a D8 pointer</a></li>
<li class="chapter" data-level="9.1.2" data-path="mersey_three.html"><a href="mersey_three.html#catchment-area"><i class="fa fa-check"></i><b>9.1.2</b> Catchment area</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mersey_three.html"><a href="mersey_three.html#task-2-seed-points"><i class="fa fa-check"></i><b>9.2</b> Task 2: Seed points</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mersey_three.html"><a href="mersey_three.html#seed-repositioning"><i class="fa fa-check"></i><b>9.2.1</b> Seed repositioning</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mersey_three.html"><a href="mersey_three.html#task-3-watershed-creation"><i class="fa fa-check"></i><b>9.3</b> Task 3: Watershed creation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mersey_four.html"><a href="mersey_four.html"><i class="fa fa-check"></i><b>10</b> Mersey IV - Surface derivatives</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mersey_four.html"><a href="mersey_four.html#task-4-reclassification"><i class="fa fa-check"></i><b>10.1</b> Task 4: Reclassification</a></li>
<li class="chapter" data-level="10.2" data-path="mersey_four.html"><a href="mersey_four.html#task-5-calculating-surface-derivatives"><i class="fa fa-check"></i><b>10.2</b> Task 5: Calculating surface derivatives</a></li>
<li class="chapter" data-level="10.3" data-path="mersey_four.html"><a href="mersey_four.html#task-6-extracting-surface-derivatives"><i class="fa fa-check"></i><b>10.3</b> Task 6: Extracting surface derivatives</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mersey_five.html"><a href="mersey_five.html"><i class="fa fa-check"></i><b>11</b> Mersey V - Statistical analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mersey_five.html"><a href="mersey_five.html#task-7-metrics"><i class="fa fa-check"></i><b>11.1</b> Task 7: Metrics</a></li>
<li class="chapter" data-level="11.2" data-path="mersey_five.html"><a href="mersey_five.html#task-8-spatial-predictions"><i class="fa fa-check"></i><b>11.2</b> Task 8: Spatial predictions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Assessment.html"><a href="Assessment.html"><i class="fa fa-check"></i><b>12</b> Assessment</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><center>
Hydrological analysis in R
</center></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Eskdale_flow_algorithms" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Eskdale III - Flow routing</h1>
<p>Overland and near-surface water flow can be modelled using DEMs if we assume that surface topography is the sole factor which influences the distribution of water. One very simple model routes all water from a particular grid cell in a DEM to a single neighbouring cell (i.e. water is not partitioned between multiple neighbours). This ‘D8’ (8 direction) method sets the flow direction toward the lowest of the eight neighbouring cells, in relation to the centre cell.</p>
<p align="center">
<a name="Figure_1"></a><img src="figures/Practical-1/D8_Principle.png" style="width:40.0%" />
</p>
<p><strong>Figure 1: Schematic of the D8 method</strong>. The elevation value of the centre cell is 8 m (dark blue). Under atmospheric pressure, water flows to areas of lower elevation (&lt; 8 m; light blue) and does not flow to areas of higher elevation (&gt;8 m; grey). In this case, the D8 method would route all the water from the centre cell into the bottom left cell, as it has the lowest value (4 m).</p>
<p>Using this method, water flow is allowed in one of eight possible directions (↑ ↗ → ↘ ↓ ↙ ← ↖), assuming that water will travel along the steepest downslope path. In turn, the method is sometimes referred to as the steepest descent method. Based on the <span class="math inline">\(3 * 3\)</span> cell neighbourhood shown in <strong>Figure 1</strong>, flow would be directed from the centre cell (8 m elevation) to the southwest cell (4 m elevation).</p>
<div id="dem-pre-processing-flow-enforcement" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> DEM pre-processing: flow enforcement</h2>
<p>One common issue encountered when performing hydrological analyses is the presence of sinks, which interrupt the drainage network. When sinks are encountered, flow direction is undefined when a grid cell, or group of grid cells, is lower than all neighbouring cells (see <strong>Figure 2</strong>) When sinks are encountered, and when there are no downslope neighbours, all water that enters a cell is unable to escape. These features are referred to as pits if they are a single cell in size, and depressions if they consist of groups of cells.</p>
<p align="center">
<a name="Figure_2"></a><img src="figures/Practical-1/DEM_Sinks.png" style="width:50.0%" />
</p>
<p><strong>Figure 2: Schematic of a sink in a DEM</strong>. In this <span class="math inline">\(5 * 5\)</span> matrix, water is routed into the top right cell (9 m) and then is routed to the lowest elevation cell at each step (9 m → 8 m → 7 m → 6 m → 2 m) using the D8 method (blue cells). However, the drainage network is interrupted by a sink at the 2 m cell (orange), as all neighbouring cells are of higher elevation.</p>
<p>Sinks can often be artefacts of the data and should be removed during DEM pre-processing. Pre-processing involves altering the elevations of the DEM in a way that enforces continuous flow-paths. However, it is important to realise that sometimes these ‘digital depressions’ reflect actual features in the landscape, and should be preserved during flow modelling. This is a particular issue for hydrological analysis of karst environments, where water can be routed into dolines and fractures (see <strong>Figure 3</strong>). However, for our work, we will assume that all depressions in DEMs are artefacts and are justified in being removed.</p>
<p align="center">
<a name="Figure_3"></a><img src="figures/Practical-1/sinkhole-image.png" style="width:50.0%" />
</p>
<p><strong>Figure 3: An example of a “true” DEM sink</strong>. A sinkhole extending into the limestone karst of Twisleton Scar, Yorkshire Dales, with Ingleborough behind (723 m). How should we model water flow in environments with sinkholes, fractures, dolines and extensive sub-surface water flow?</p>
<p>Several methods have been developed for removing depressions from DEMs. These methods vary greatly in terms of their sophistication and impact on the DEM. The two most common depression removal methods (<strong>Figure 4</strong>) are:</p>
<ul>
<li>depression <strong>filling</strong>, which raises cells within a depression to the elevation of the outlet cell;</li>
<li>depression <strong>breaching</strong>, which digs a trench from a depression’s bottom to some point downslope.</li>
</ul>
<p><br/></p>
<p align="center">
<a name="Figure_3"></a><img src="figures/Practical-1/DEM_Sinks_Fix.png" style="width:100.0%" />
</p>
<p><strong>Figure 4: Schematic of depression filling and breaching in a DEM</strong>. Using the same values from Figure 2, original values are modified to allow water to escape the sink (orange). Depression filling has raised the value of the sink (2 m → 4 m), while depression breaching has lowered the value of a neighbouring cell (3 m → 1 m). In this simplified example, the outputs of these two distinct approaches are identical but care should be taken when working with real world data as they will often produce different results.</p>
<p>Not all interruptions to flow routing are caused by depression cells. Often, DEMs contain extensive flat regions (areas of equal elevation). Flat areas interrupt flow routing in the same way as depressions. Cells within a flat region do not have downslope neighbours, and therefore, flow routing is impossible on flat sites without pre-processing. Correction of flow direction on flat sites typically involves finding an outlet cell, forcing flow from cells adjacent to the outlet to the outlet, and continuing backwards in an iterative manner (e.g., <span class="citation"><a href="#ref-jenson_extracting_1988" role="doc-biblioref">Jenson and Domingue</a> (<a href="#ref-jenson_extracting_1988" role="doc-biblioref">1988</a>)</span>).</p>
<div id="data-description" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Data description</h3>
<p>The DEM we are working with is centred on the Upper Eskdale catchment; an upland valley which drains the highest mountain in England (Scafell Pike; 978 m), as shown below:</p>
<p align="center">
<a name="Figure_4"></a><img src="figures/Practical-1/Eskdale_image.png" style="width:100.0%" />
</p>
<p><strong>Figure 5: Upper Eskdale panorama</strong>, viewed from Harter Fell [Location: 54.386907, -3.205004, Elevation: 649 m]. The catchment ranges in elevation from 978 m (Scafell Pike) to ~160 m at the catchment outlet (white circle), and is ringed by numerous summits with elevations in excess of 800 m (white triangles). The catchment has an area of ~15.7 km<sup>2</sup> and all water which falls with the catchment ultimately drains to the Irish Sea via the River Esk.</p>
<p>You can explore the catchment below:</p>
<div id="htmlwidget-1d6ba5a2721f7857e6d1" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1d6ba5a2721f7857e6d1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[54.4363748975103,-3.19096872162999],12.1,[]],"calls":[{"method":"addProviderTiles","args":["OpenTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[54.412119851,-3.204500685,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Catchment Outlet (~160 m)",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[54.412119851,54.412119851],"lng":[-3.204500685,-3.204500685]}},"evals":[],"jsHooks":[]}</script>
<p><br/></p>
<p>The DEM we are working with was downloaded from <a href="https://digimap.edina.ac.uk/">EDINA Digimap</a>, has a cell size of 10 m and uses the <strong>British National Grid</strong> (BNG), a <strong>projected</strong> coordinate Reference System [<a href="https://epsg.io/27700">EPSG:27700</a>].</p>
<p>Unfortunately, we don’t have time in this course to delve into the exciting world of map projections, although these are covered excellently by Dr. Jonny Huck in the Semester 2 course <a href="https://www.manchester.ac.uk/study/masters/courses/list/07053/msc-geographical-information-science/course-details/GEOG71552#course-unit-details"><strong>Understanding GIS</strong></a>. However, it is important to know that different map projections have different uses and work more/less effectively in different regions. As we are working within the UK, it makes sense to use a map projection which is tailored to the UK (e.g. BNG) as this minimises different types of map distortion (length, shape, area).</p>
<p>When loaded into R using the <code>raster</code> package and plotted using <code>ggplot2</code> and <code>ggspatial</code>, our DEM can be visualised as follows, where the outlet point (white circle) and summits (black triangles) match those shown in Figure 5.</p>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-58-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To accentuate areas of relief, the DEM has been combined with a semi-transparent <strong>hillshade</strong> layer, which is shown below:</p>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="breaching-and-filling" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Breaching and filling</h3>
<p>To evaluate the effects of depression <strong>breaching</strong> and <strong>filling</strong>, we’re going to use the <code>whitebox</code> package and the <code>wbt_fill_depressions</code> and <code>wbt_breach_depressions</code> functions. One of the advantages of using <code>whitebox</code> is that functions can be applied to spatial data without having to load files into the R environment (and assign them to variables), which can be an issue when working with large files (e.g. high spatial resolution rasters) or when working on computers with limited available memory.</p>
<p>We can <strong>call</strong> <code>whitebox</code> functions by simply naming the function, specifying the names of the input and output layers, and deciding on parameters (if required). For example, the code to fill depressions, might resemble the following:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="Eskdale_flow_algorithms.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill depressions</span></span>
<span id="cb71-2"><a href="Eskdale_flow_algorithms.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_fill_depressions</span>(<span class="st">&quot;name of input file goes here&quot;</span>, <span class="st">&quot;name of output file goes here&quot;</span>)</span></code></pre></div>
<p>Given the structure of our file directory, this could be written as:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="Eskdale_flow_algorithms.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill depressions</span></span>
<span id="cb72-2"><a href="Eskdale_flow_algorithms.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_fill_depressions</span>(<span class="st">&quot;C:/Users/Bill/GEOG-70581/data/practical_1/dem_10m.tif&quot;</span>, </span>
<span id="cb72-3"><a href="Eskdale_flow_algorithms.html#cb72-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;C:/Users/Bill/GEOG-70581/output/practical_1/dem_10m_fill.tif&quot;</span>)</span></code></pre></div>
<p>Here, we’ve using absolute file paths to set the input DEM as <code>dem_10m.tif</code> (stored in data/practical_1) and have specified the output DEM as <code>dem_10m_fill.tif</code>. The function <code>wbt_fill_depressions</code> will fill depressions in the input DEM and save the new DEM as <code>dem_10m_fill.tif</code> in output/practical_1.</p>
<p>However, because we’re using an R project we can simplify this further. As we’ll be using the DEM (<code>dem_10m.tif</code>) on multiple occasions, we can store its file path using the <strong>here</strong> package in the variable <code>dem</code> as follows:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="Eskdale_flow_algorithms.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sets file path for DEM</span></span>
<span id="cb73-2"><a href="Eskdale_flow_algorithms.html#cb73-2" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m.tif&quot;</span>)</span>
<span id="cb73-3"><a href="Eskdale_flow_algorithms.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="Eskdale_flow_algorithms.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints the file path to the console window</span></span>
<span id="cb73-5"><a href="Eskdale_flow_algorithms.html#cb73-5" aria-hidden="true" tabindex="-1"></a>dem</span></code></pre></div>
<blockquote>
<p>Copy and paste the above code into your Practical-1-Eskdale script and run. This should print the absolute file path to <code>dem_10m.tif</code>.</p>
</blockquote>
<p>With this file path stored, we can run the fill depressions function as follows, using the <strong>here</strong> package to specify the name and intended location of the <strong>output</strong> file:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="Eskdale_flow_algorithms.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fills depressions</span></span>
<span id="cb74-2"><a href="Eskdale_flow_algorithms.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_fill_depressions</span>(dem, <span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_fill.tif&quot;</span>))</span></code></pre></div>
<blockquote>
<p>Run the above code, which should produce a new raster file in the output/practical_1 folder.</p>
</blockquote>
<blockquote>
<p>Repeat this process to also <strong>breach</strong> depressions, making sure to update the output file name.</p>
</blockquote>
<p>The difference between the original DEM and the processed DEM(s) may be very subtle and you probably won’t be able to observe the differences directly. As such, it may be useful to identify the specific areas of the raster which have been modified. This can be achieved by using the <code>subtract</code> function to work out the difference between the original DEM and the processed DEM, as follows:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="Eskdale_flow_algorithms.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtract function; the difference between the processed DEM (filled) and the original DEM</span></span>
<span id="cb75-2"><a href="Eskdale_flow_algorithms.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_subtract</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_fill.tif&quot;</span>), <span class="co"># Input file 1</span></span>
<span id="cb75-3"><a href="Eskdale_flow_algorithms.html#cb75-3" aria-hidden="true" tabindex="-1"></a>              dem, <span class="co"># Input file 2</span></span>
<span id="cb75-4"><a href="Eskdale_flow_algorithms.html#cb75-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_fill_difference.tif&quot;</span>)) <span class="co"># Output file</span></span></code></pre></div>
<blockquote>
<p>Run the above code.</p>
</blockquote>
<p>To visualise this new raster file, we’re going to load it into the R environment using the <code>raster</code> and <code>here</code> packages and plot with <code>ggplot2</code> and <code>ggspatial</code>.</p>
<p>The raster can be loaded as follows:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="Eskdale_flow_algorithms.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loads raster using the raster and here packages</span></span>
<span id="cb76-2"><a href="Eskdale_flow_algorithms.html#cb76-2" aria-hidden="true" tabindex="-1"></a>eskdale_dem <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_fill_difference.tif&quot;</span>))</span></code></pre></div>
<p>It can be plotted as follows:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="Eskdale_flow_algorithms.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find minimum and maximum values</span></span>
<span id="cb77-2"><a href="Eskdale_flow_algorithms.html#cb77-2" aria-hidden="true" tabindex="-1"></a>minimum_value <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">values</span>(eskdale_dem)[<span class="fu">which</span>(<span class="fu">values</span>(eskdale_dem) <span class="sc">&gt;</span> <span class="dv">0</span>)])</span>
<span id="cb77-3"><a href="Eskdale_flow_algorithms.html#cb77-3" aria-hidden="true" tabindex="-1"></a>maximum_value <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">values</span>(eskdale_dem))</span>
<span id="cb77-4"><a href="Eskdale_flow_algorithms.html#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="Eskdale_flow_algorithms.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots using ggplot</span></span>
<span id="cb77-6"><a href="Eskdale_flow_algorithms.html#cb77-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-7"><a href="Eskdale_flow_algorithms.html#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_spatial</span>(eskdale_dem, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">stat</span>(band1))) <span class="sc">+</span></span>
<span id="cb77-8"><a href="Eskdale_flow_algorithms.html#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb77-9"><a href="Eskdale_flow_algorithms.html#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Elevation difference (m)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Easting&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Northing&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-10"><a href="Eskdale_flow_algorithms.html#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">type =</span> <span class="st">&quot;viridis&quot;</span>,  <span class="at">na.value =</span> <span class="cn">NA</span>, </span>
<span id="cb77-11"><a href="Eskdale_flow_algorithms.html#cb77-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits =</span> <span class="fu">c</span>(minimum_value, maximum_value))</span>
<span id="cb77-12"><a href="Eskdale_flow_algorithms.html#cb77-12" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Most of the above should be familiar to you, with a few exceptions:</p>
<ul>
<li>Under <code>scale_fill_continuous()</code>, we’ve set limits for the fill symbology. This now ranges between the maximum value, calculated using <code>max(values(dem))</code>, and the minimum value that is <strong>greater than 0</strong>, calculated using <code>minimum_value &lt;- min(values(dem)[which(values(dem) &gt; 0)])</code>. The latter is useful because most of the DEM was unmodified by <code>wbt_fill_depressions</code> so most raster cells contain a value of 0.</li>
<li>The <code>layer spatial()</code> is a non-standard geom type and is available through the <code>ggspatial</code> package. This simplifies the process of plotting raster data in ggplot2, and this approach should be replicated for future plotting.</li>
</ul>
<blockquote>
<p>Run the above code elements to reproduce the plot above. You can remove <code>limits</code> from the <code>scale_fill_continuous()</code> argument to plot the actual distribution of DEM values.</p>
</blockquote>
<blockquote>
<p>Question: to what degree has the original DEM been modified by the <code>wbt_fill_depressions</code> function? Consider the <strong>spatial extent</strong> and <strong>magnitude</strong> of the observed differences.</p>
</blockquote>
<p><strong>Note</strong>: For this catchment, the difference between DEM breaching and filling is relatively minor. We’ll use the latter (<code>dem_10m_fill.tif</code>) for all subsequent calculations.</p>
<p>As outlined above, the areas which are most affected by the depression filling algorithm are partly determined by local relief i.e. relatives differences in elevation. To help visualise this, let’s create and plot a <strong>slope</strong> image for the area, where the values in the raster cells represent the gradient of the slope, rather than their raw elevation. This can be achieved using the <code>wbt_slope</code> function.</p>
<blockquote>
<p>Using the examples above, run <code>wbt_slope</code>, using the original DEM as the input, saving the output file with a logical name (e.g. <code>dem_10m_slope.tif</code>) and to the correct sub-directory (output/practical_1).</p>
</blockquote>
<blockquote>
<p>Load the data into R and plot using ggplot2. Your figure should resemble the following:</p>
</blockquote>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-68-1.png" width="672" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Compare the ‘slope’ and ‘difference’ images. <strong>Hint</strong>: you can toggle between plots using the left and right arrows in the plot window. Based on your visual inspection the images, which parts of the landscape appear to have been affected by the depression filling algorithm? Why do you think that this is the case?</p>
</blockquote>
<p>Before we move on to further analysis, it is worth thinking carefully about the <strong>symbology</strong> we are using for our raster layers. This is important, because not all colour ramps are created equal! Colour ramps differ in terms of their <strong>perceptual uniformity</strong> and their accessibility for <strong>colour-blind</strong> individuals.</p>
</div>
<div id="choosing-a-colour-ramp" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Choosing a colour ramp</h3>
<p>Perceptual uniformity refers to how well a colour ramp represents the underlying data. Some (e.g. <a href="https://www.climate-lab-book.ac.uk/2014/endof-%20the-rainbow/">rainbow</a>; <span class="citation"><a href="#ref-hawkins_scrap_2015" role="doc-biblioref">Hawkins</a> (<a href="#ref-hawkins_scrap_2015" role="doc-biblioref">2015</a>)</span>) can introduce artificial boundaries (<span class="citation"><a href="#ref-alcalde_framing_2017" role="doc-biblioref">Alcalde <em>et al.</em></a> (<a href="#ref-alcalde_framing_2017" role="doc-biblioref">2017</a>)</span>) which influence how we assess and then use that data (see <a href="https://blogs.egu.eu/divisions/gd/2017/08/23/the-rainbow-colour-map/">here</a>. In the schematic below, there are numerous artificial boundaries in the rainbow colour ramp (e.g. dark blue → light blue, light blue → green, green → yellow, yellow → orange), whereas the monochrome colour ramp smoothly transitions from black → white.</p>
<p align="center">
<a name="Figure_6"></a><img src="figures/Practical-1/Perceptual_Colour_Ramps.png" style="width:50.0%" />
</p>
<p>The <strong>viridis</strong> colour ramp we have been using so far <strong>is</strong> perceptually uniform, but others are not.</p>
<blockquote>
<p>Inspect Figure 6 below. These show the same slope raster, but one is visualised using <em>rainbow</em>, while the other uses a monochrome (perceptually-uniform) colour ramp. Does this influence how you interpret the data?</p>
</blockquote>
<p align="center">
<a name="Figure_6"></a><img src="figures/Practical-1/colour-scales.png" style="width:100.0%" />
</p>
<p><strong>Figure 6: Perceptual uniformity</strong> with rainbow and monochrome colour ramps.</p>
<p>In a similar fashion, not all colour ramps are suitable for individuals with various forms of colour-blindness (see <span class="citation"><a href="#ref-levine_using_2009" role="doc-biblioref">Levine</a> (<a href="#ref-levine_using_2009" role="doc-biblioref">2009</a>)</span> and <span class="citation"><a href="#ref-geissbuehler_how_2013" role="doc-biblioref">Geissbuehler and Lasser</a> (<a href="#ref-geissbuehler_how_2013" role="doc-biblioref">2013</a>)</span>), who may have difficulty distinguishing reds from greens, or yellows from blues. Luckily, there are now a range of perceptually uniform and colour-blind friendly colour ramps (e.g. <span class="citation"><a href="#ref-crameri_geodynamic_2018" role="doc-biblioref">Crameri</a> (<a href="#ref-crameri_geodynamic_2018" role="doc-biblioref">2018</a>)</span>), including <a href="http://www.fabiocrameri.ch/colourmaps.php">Scientific Colour Maps 6.0</a>. These can be downloaded and used across a range of GIS programs to suit a range of data types. For now, utilise the colour ramps available in R (i.e. viridis) but bear these issues in mind for future map creation.</p>
</div>
</div>
<div id="flow-parameters-pointers" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Flow Parameters: Pointers</h2>
<p>Now that we have a DEM that has had all interruptions to flow removed, we can continue to calculate the data needed to define the drainage network i.e. the topological network describing how each cell in a DEM is connected to all others.</p>
<p>One key input for drainage network calculations is a <strong>pointer file</strong>, which stores the flow direction of each cell in a raster grid, and thus, the topology of the drainage network. The exact nature of these data depends on the method used to derive the flow directions. Whitebox Tools stores D8 pointers as binary numbers in base-2, as follows:</p>
<p align="center">
<a name="Figure_7"></a><img src="figures/Practical-1/pointer-file.png" style="width:100.0%" />
</p>
<p>We’ll explore the reason for this in Practical 2. In our earlier example of the D8 flow algorithm (see Figure 1), the flow direction was to the <strong>SW</strong>. This has a binary value of <span class="math inline">\(2^4 = 16\)</span>. Therefore, in the pointer file, the highlighted dark blue cell would be assigned a value of 16.</p>
<p>Several sub-programs in Whitebox Tools use pointer files to calculate other terrain data, including the algorithms used to calculate catchment area (see below). However, sub-programs rarely require a pointer file as an input, as WBT will automatically generate a pointer layer from the input DEM when required, before discarding the file afterwards. While this processing step is not readily apparent to the user, it is important to realise that it occurs, and it is often good practice to generate a pointer file manually. This can be achieved using the <code>wbt_d8_pointer</code> function.</p>
<blockquote>
<p>Using the understanding gained above, run the <code>wbt_d8_pointer</code> function, using the correct input files and output file name and directory. Load the raster into R and plot. Your output should resemble the following, where each cell value has been reclassified according to the D8 flow.</p>
</blockquote>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-70-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>While this is an acceptable plot, it is actually slightly misleading, because the scale bar is <em>continuous</em>, despite the fact that our underlying data are <em>discrete</em> i.e. there are only eight possible values, which are listed below:</p>
<ul>
<li><span class="math inline">\(2^0 = 1\)</span></li>
<li><span class="math inline">\(2^1 = 2\)</span></li>
<li><span class="math inline">\(2^2 = 4\)</span></li>
<li><span class="math inline">\(2^3 = 8\)</span></li>
<li><span class="math inline">\(2^4 = 16\)</span></li>
<li><span class="math inline">\(2^5 = 32\)</span></li>
<li><span class="math inline">\(2^6 = 64\)</span></li>
<li><span class="math inline">\(2^7 = 128\)</span></li>
</ul>
<p>Here is the same data but using a discrete scale:</p>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-71-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>which is described here:</p>
<p align="center">
<a name="Figure_8"></a><img src="figures/Practical-1/pointer-styling.png" style="width:50.0%" />
</p>
<blockquote>
<p>Question: Can you think of any issues with symbolising pointer data?</p>
</blockquote>
</div>
<div id="flow-algorithms" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Flow Algorithms</h2>
<p>Once you have determined how each grid cell in a DEM is connected to its neighbours, it is possible to use this pointer information to calculate the number of grid cells that are connected to each cell in an upslope (catchment area) and downslope (dispersal area) direction. These data describe the spatial pattern of upslope (or downslope) area draining to (or away from) each pixel in a DEM.</p>
<p>Measures of catchment area are often used for stream network extraction and other terrain indices. There are three primary measures of catchment area:</p>
<ul>
<li>Number of Upslope Elements (<strong>NUE</strong>): the number of cells draining to each grid cell;</li>
<li>Upslope Contributing Area (<strong>UCA</strong>): the NUE multiplied by the cell area;</li>
<li>Specific Contributing Area (<strong>SCA</strong>): the UCA divided by the cell size or grid resolution.</li>
</ul>
<p>The SCA characterises the amount of flow across a unit length of contour in the catchment. Unlike the NUE and UCA, SCA is not affected by the grid resolution of the DEM.</p>
<p>To calculate the upslope catchment area for each raster cell, we can use the <code>wbt_d8_flow_accumulation</code> function.</p>
<blockquote>
<p>Run the above function, using the filled DEM as the input file and the output type (<code>out_type</code>) as ‘specific contributing area’ (in quotation marks). As SCA data typically have a very large range of values, we can also log-transform the flow accumulation values (<code>log = "TRUE"</code>) to improve plot readability. Save the output file with a logical name (e.g. <code>dem_10m_flow_accumulation.tif</code>) and to the correct sub-directory (output/practical_1). Load the raster to R and plot, and your output should resemble the following:</p>
</blockquote>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="Eskdale_flow_algorithms.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates accumulation file</span></span>
<span id="cb78-2"><a href="Eskdale_flow_algorithms.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_d8_flow_accumulation</span>(<span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_fill.tif&quot;</span>), </span>
<span id="cb78-3"><a href="Eskdale_flow_algorithms.html#cb78-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">here</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;practical_1&quot;</span>, <span class="st">&quot;dem_10m_flow_accumulation.tif&quot;</span>), </span>
<span id="cb78-4"><a href="Eskdale_flow_algorithms.html#cb78-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">out_type =</span> <span class="st">&quot;specific contributing area&quot;</span>, </span>
<span id="cb78-5"><a href="Eskdale_flow_algorithms.html#cb78-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">log =</span> <span class="st">&quot;TRUE&quot;</span>)</span></code></pre></div>
<p><img src="Practical_1_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Inspect the map output. <strong>Question</strong>: Which parts of the landscape have low/high values of SCA, respectively?</p>
</blockquote>
<div id="comparing-flow-algorithms" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Comparing flow algorithms</h3>
<p>So far we have used the most simplistic flow algorithm (D8) to model specific catchment area (SCA). However, there are many flow algorithms available (e.g. <span class="citation"><a href="#ref-fairfield_drainage_1991" role="doc-biblioref">Fairfield and Leymarie</a> (<a href="#ref-fairfield_drainage_1991" role="doc-biblioref">1991</a>)</span>, <span class="citation"><a href="#ref-seibert_new_2007" role="doc-biblioref">Seibert and McGlynn</a> (<a href="#ref-seibert_new_2007" role="doc-biblioref">2007</a>)</span>, <span class="citation"><a href="#ref-grabs_calculating_2010" role="doc-biblioref">Grabs <em>et al.</em></a> (<a href="#ref-grabs_calculating_2010" role="doc-biblioref">2010</a>)</span>) and each algorithm results in slightly different spatial patterns of catchment area. As flow routing is fundamental to the modelling of surface water hydrology, it is important to familiarise yourself with several commonly used methods, although it can be difficult to decide when or where it is appropriate to use a particular routing algorithm. In this section of the practical, we will compare the output of three flow routing algorithms including:</p>
<ul>
<li><strong>D8</strong>: see <span class="citation"><a href="#ref-ocallaghan_extraction_1984" role="doc-biblioref">O’Callaghan and Mark</a> (<a href="#ref-ocallaghan_extraction_1984" role="doc-biblioref">1984</a>)</span></li>
<li><strong>FD8</strong>: see <span class="citation"><a href="#ref-freeman_calculating_1991" role="doc-biblioref">Freeman</a> (<a href="#ref-freeman_calculating_1991" role="doc-biblioref">1991</a>)</span>, <span class="citation"><a href="#ref-quinn_prediction_1991" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_prediction_1991" role="doc-biblioref">1991</a>)</span> and its modification by <span class="citation"><a href="#ref-quinn_tan_1995" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_tan_1995" role="doc-biblioref">1995</a>)</span></li>
<li><strong>D-infinity</strong>: see <span class="citation"><a href="#ref-tarboton_new_1997" role="doc-biblioref">Tarboton</a> (<a href="#ref-tarboton_new_1997" role="doc-biblioref">1997</a>)</span>;</li>
</ul>
<p>Flow algorithms differ in the way in which they:</p>
<ul>
<li>calculate flow direction;</li>
<li>model flow divergence, i.e., partition flow between neighbouring downslope cells;</li>
<li>handle streams.</li>
</ul>
<p>The D8 algorithm is incapable of modelling flow divergence (or dispersion) because the flow from a particular grid cell is directed to a single downslope neighbour. FD8 (i.e. fractional D8; <span class="citation"><a href="#ref-freeman_calculating_1991" role="doc-biblioref">Freeman</a> (<a href="#ref-freeman_calculating_1991" role="doc-biblioref">1991</a>)</span>, <span class="citation"><a href="#ref-quinn_prediction_1991" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_prediction_1991" role="doc-biblioref">1991</a>)</span>) divides flow to each downslope neighbour using a partitioning scheme that is based on the slope angle to neighbouring cells, while a later modification by <span class="citation"><a href="#ref-quinn_tan_1995" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_tan_1995" role="doc-biblioref">1995</a>)</span> increases the degree of flow convergence from the catchment divide to the channel head. Finally, D-infinity divide flows between a maximum of two downslope neighbours based on the direction of maximum downward slope. Of these, FD8-Quinn (<span class="citation"><a href="#ref-quinn_tan_1995" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_tan_1995" role="doc-biblioref">1995</a>)</span>) is the only algorithm of the three that explicitly recognises that flow on hillslopes should be divergent while flow along valley bottoms should be convergent.</p>
<p>In the final part of the practical, assess the specific catchment areas (SCA) derived from each of the flow algorithms discussed above.</p>
</div>
<div id="fd8-catchment-area" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> FD8 catchment area</h3>
<p>To calculate the catchment area using the FD8 algorithm (<span class="citation"><a href="#ref-freeman_calculating_1991" role="doc-biblioref">Freeman</a> (<a href="#ref-freeman_calculating_1991" role="doc-biblioref">1991</a>)</span>; <span class="citation"><a href="#ref-quinn_prediction_1991" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_prediction_1991" role="doc-biblioref">1991</a>)</span>; <span class="citation"><a href="#ref-quinn_tan_1995" role="doc-biblioref">Quinn <em>et al.</em></a> (<a href="#ref-quinn_tan_1995" role="doc-biblioref">1995</a>)</span>), use the <code>wbt_fd8_flow_accumulation</code> function.</p>
<blockquote>
<p>Use the <code>wbt_fd8_flow_accumulation</code> function, making sure to select ‘specific contributing area’ and remembering to log-transform the values. The exponent parameter should be set to 1.1 (<code>exponent = 1.1</code>), as suggested by <span class="citation"><a href="#ref-freeman_calculating_1991" role="doc-biblioref">Freeman</a> (<a href="#ref-freeman_calculating_1991" role="doc-biblioref">1991</a>)</span>. Save with an appropriate name (e.g. <code>dem_10m_flow_accumulation_fd8.tif</code>). Load the raster in R and plot.</p>
</blockquote>
</div>
<div id="d-infinity-catchment-area" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> D-infinity catchment area</h3>
<p>To calculate the catchment area using the D-infinity algorithm of <span class="citation"><a href="#ref-tarboton_new_1997" role="doc-biblioref">Tarboton</a> (<a href="#ref-tarboton_new_1997" role="doc-biblioref">1997</a>)</span>:</p>
<blockquote>
<p>Use <code>wbt_d_inf_flow_accumulation</code>. Use the same input parameters as above (i.e. SCA, log-transformed values). Save with an appropriate name (e.g. <code>dem_10m_flow_accumulation_d_inf.tif</code>). Load the raster in R and plot.</p>
</blockquote>
</div>
<div id="comparing-the-outputs" class="section level3" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Comparing the outputs</h3>
<p>The output of the algorithms should resemble the following:</p>
<p align="center">
<a name="Figure_7"></a><img src="figures/Practical-1/three-methods.png" style="width:100.0%" />
</p>
<p><strong>Figure 7: Flow algorithm comparison</strong>. Results from the D8, FD8 and D-Infinity algorithms. Plot created using <code>ggplot2</code> and the <code>patchwork</code> package (useful for combining plots).</p>
<p>When water flows over a hillslope, you would expect there to be some degree of divergence depending on the topography (i.e. some hillslopes are convergent and some are divergent). However, once water becomes channelised, you would no longer expect flow to be divergent. Once water is in a channel it stays there until it reaches a lake or ocean. Branching in channels is rather rare. So let’s assume that the pattern of SCA should display some degree of dispersion on hillslopes and no dispersion at all along valley bottoms (i.e. in streams). Flow divergence or dispersion is apparent in SCA images by a ‘fuzzy’ quality, almost like the SCA has been smudged. You can zoom into individual plots using the <strong>Zoom</strong> button in the Plot Window or edit the x- and y-axis limits of your plots by adding the following to your <code>ggplot2</code> call:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Eskdale_flow_algorithms.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sets x- and y-axis limits using coord_sf()</span></span>
<span id="cb79-2"><a href="Eskdale_flow_algorithms.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">504063</span>,<span class="dv">506727</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">320705</span>, <span class="dv">322255</span>))</span></code></pre></div>
<p>The above code uses British National Grid coordinates (m), rather than decimal degrees.</p>
<p><br/></p>
<p><strong>To finish Practical 1</strong>, complete the following:</p>
<blockquote>
<p>Compare the D8, FD8 and D-Inf outputs. Either cycle between the plots using the plot window or combine them using the <code>patchwork</code> package. This would need to be installed and loaded to the library.</p>
</blockquote>
<blockquote>
<p>Which algorithms do a good job modelling the pattern of contributing area on hillslopes?</p>
</blockquote>
<blockquote>
<p>Can you see signs of flow divergence along streams in any of the SCA images? Which algorithms perform best for modelling the pattern of SCA in fluvial (stream) environments?</p>
</blockquote>
<blockquote>
<p>Do any of the algorithms do a good job for both hillslopes and streams?</p>
</blockquote>
<p><br/></p>
<p><strong>Congratulations!</strong> You have now completed the Practical 1 (Eskdale; Chapters 4 - 6). You now have considerable experience running <code>whitebox</code> functions as well as visualising spatial data using <code>ggplot2</code>.</p>
<p><br/></p>
</div>
</div>
<div id="practical-solution" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Practical solution</h2>
<p>As with the introduction to R (Chapter 2 - 3), I will provide a code solution to the Eskdale practical (Chapters 4 - 6), outlining the major analytical steps.</p>
<p>This will be released prior to the Week 10 class (scheduled for 3/12/2021).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="Eskdale_flow_algorithms.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution to Practical 1 (Eskdale)</span></span>
<span id="cb80-2"><a href="Eskdale_flow_algorithms.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: matt-tomkins</span></span>
<span id="cb80-3"><a href="Eskdale_flow_algorithms.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Date of upload: xx-xx-xxxx</span></span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-alcalde_framing_2017" class="csl-entry">
Alcalde, J. <em>et al.</em> (2017) <span>‘Framing bias: <span>The</span> effect of figure presentation on seismic interpretation’</span>, <em>Interpretation</em>, 5(4), pp. T591–T605. doi:<a href="https://doi.org/10.1190/INT-2017-0083.1">10.1190/INT-2017-0083.1</a>.
</div>
<div id="ref-crameri_geodynamic_2018" class="csl-entry">
Crameri, F. (2018) <span>‘Geodynamic diagnostics, scientific visualisation and <span>StagLab</span> 3.0’</span>, <em>Geoscientific Model Development</em>, 11(6), pp. 2541–2562. doi:<a href="https://doi.org/10.5194/gmd-11-2541-2018">https://doi.org/10.5194/gmd-11-2541-2018</a>.
</div>
<div id="ref-fairfield_drainage_1991" class="csl-entry">
Fairfield, J. and Leymarie, P. (1991) <span>‘Drainage networks from grid digital elevation models’</span>, <em>Water Resources Research</em>, 27(5), pp. 709–717. doi:<a href="https://doi.org/10.1029/90WR02658">https://doi.org/10.1029/90WR02658</a>.
</div>
<div id="ref-freeman_calculating_1991" class="csl-entry">
Freeman, T.G. (1991) <span>‘Calculating catchment area with divergent flow based on a regular grid’</span>, <em>Computers &amp; Geosciences</em>, 17(3), pp. 413–422. doi:<a href="https://doi.org/10.1016/0098-3004(91)90048-I">10.1016/0098-3004(91)90048-I</a>.
</div>
<div id="ref-geissbuehler_how_2013" class="csl-entry">
Geissbuehler, M. and Lasser, T. (2013) <span>‘How to display data by color schemes compatible with red-green color perception deficiencies’</span>, <em>Optics Express</em>, 21(8), pp. 9862–9874. doi:<a href="https://doi.org/10.1364/OE.21.009862">10.1364/OE.21.009862</a>.
</div>
<div id="ref-grabs_calculating_2010" class="csl-entry">
Grabs, T.J. <em>et al.</em> (2010) <span>‘Calculating terrain indices along streams: <span>A</span> new method for separating stream sides’</span>, <em>Water Resources Research</em>, 46(12). doi:<a href="https://doi.org/10.1029/2010WR009296">https://doi.org/10.1029/2010WR009296</a>.
</div>
<div id="ref-hawkins_scrap_2015" class="csl-entry">
Hawkins, E. (2015) <span>‘Scrap rainbow colour scales’</span>, <em>Nature</em>, 519(7543), pp. 291–291. doi:<a href="https://doi.org/10.1038/519291d">10.1038/519291d</a>.
</div>
<div id="ref-jenson_extracting_1988" class="csl-entry">
Jenson, S.K. and Domingue, J.O. (1988) <span>‘Extracting topographic structure from digital elevation data for geographic information-system analysis’</span>, <em>Photogrammetric Engineering and Remote Sensing</em>, 54(11), p. 15931600. Available at: <a href="http://pubs.er.usgs.gov/publication/70142175">http://pubs.er.usgs.gov/publication/70142175</a> (Accessed: 2 December 2020).
</div>
<div id="ref-levine_using_2009" class="csl-entry">
Levine, T. (2009) <span>‘Using colour in figures: Let’s agree to differ’</span>, <em>Traffic</em>, 10(3), pp. 344–347. doi:<a href="https://doi.org/10.1111/j.1600-0854.2008.00863.x">https://doi.org/10.1111/j.1600-0854.2008.00863.x</a>.
</div>
<div id="ref-ocallaghan_extraction_1984" class="csl-entry">
O’Callaghan, J.F. and Mark, D.M. (1984) <span>‘The extraction of drainage networks from digital elevation data’</span>, <em>Computer Vision, Graphics, and Image Processing</em>, 28(3), pp. 323–344. doi:<a href="https://doi.org/10.1016/S0734-189X(84)80011-0">10.1016/S0734-189X(84)80011-0</a>.
</div>
<div id="ref-quinn_prediction_1991" class="csl-entry">
Quinn, P. <em>et al.</em> (1991) <span>‘The prediction of hillslope flow paths for distributed hydrological modelling using digital terrain models’</span>, <em>Hydrological Processes</em>, 5(1), pp. 59–79. doi:<a href="https://doi.org/10.1002/hyp.3360050106">https://doi.org/10.1002/hyp.3360050106</a>.
</div>
<div id="ref-quinn_tan_1995" class="csl-entry">
Quinn, P.F. <em>et al.</em> (1995) <span>‘The in(a/tan/β) index: <span>How</span> to calculate it and how to use it within the topmodel framework’</span>, <em>Hydrological Processes</em>, 9(2), pp. 161–182. doi:<a href="https://doi.org/10.1002/hyp.3360090204">https://doi.org/10.1002/hyp.3360090204</a>.
</div>
<div id="ref-seibert_new_2007" class="csl-entry">
Seibert, J. and McGlynn, B.L. (2007) <span>‘A new triangular multiple flow direction algorithm for computing upslope areas from gridded digital elevation models’</span>, <em>Water Resources Research</em>, 43(4). doi:<a href="https://doi.org/10.1029/2006WR005128">https://doi.org/10.1029/2006WR005128</a>.
</div>
<div id="ref-tarboton_new_1997" class="csl-entry">
Tarboton, D.G. (1997) <span>‘A new method for the determination of flow directions and upslope areas in grid digital elevation models’</span>, <em>Water Resources Research</em>, 33(2), pp. 309–319. doi:<a href="https://doi.org/10.1029/96WR03137">https://doi.org/10.1029/96WR03137</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Eskdale_set_up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SecondPractical.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
